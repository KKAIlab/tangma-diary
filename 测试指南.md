# 糖妈日记 - 功能测试指南

## 📋 测试检查清单

### 1. 基础功能测试

#### ✅ 数据导出测试
1. 打开应用：https://kkailab.github.io/tangma-diary/
2. 点击底部"指南"标签
3. 找到"数据管理"区域
4. 点击"📤 导出数据"按钮
5. **预期结果**：下载一个 JSON 文件，文件名类似 `糖妈日记_2025-12-18.json`

**检查导出的JSON文件内容：**
```json
{
  "version": "1.0",
  "exportDate": "2025-12-18T...",
  "data": [
    {
      "date": "12月5日",
      "weekday": "周四",
      "weight": 68.3,
      "fasting": 94,
      "steps": null,
      "meals": [...]
    },
    ...
  ]
}
```

#### ✅ 数据导入测试
1. 备份当前数据（导出一次）
2. 点击"📥 导入数据"按钮
3. 选择刚才导出的 JSON 文件
4. 点击确认
5. **预期结果**：页面刷新，数据恢复

#### ✅ 添加记录测试（关键！）
**测试今天（12月18日）的新记录：**

1. 点击底部中间的 ➕ 按钮
2. 填写以下测试数据：
   - 餐次：早餐
   - 食物：`玄米饭，鸡蛋，西兰花`
   - 餐后血糖：`115`
   - 测量时间：`09:30`
3. 点击"保存记录"
4. **预期结果**：
   - 弹出"✅ 记录保存成功"
   - 首页显示今天（12月18日）的记录
   - 日期选择器最后一个日期是"18"

#### ✅ 日期选择器测试
1. 查看顶部的日期选择器横向滚动条
2. **预期结果**：
   - 能看到 5日-18日的所有日期
   - 最新日期（18日）自动高亮选中
   - 有数据的日期下方有绿点标识

#### ✅ 数据持久化测试
1. 添加一条新记录
2. 关闭浏览器标签页
3. 重新打开 https://kkailab.github.io/tangma-diary/
4. **预期结果**：刚才添加的记录还在

### 2. 数据清除测试

#### ⚠️ 清除所有数据（慎重！）
1. 先导出备份当前数据
2. 点击"🗑️ 清除所有数据"
3. 确认两次
4. **预期结果**：页面刷新，恢复到示例数据

### 3. 新日期跨越测试

#### 测试场景：添加未来日期的记录

由于当前系统会自动使用今天的日期，如果需要测试跨月或跨年：

**方法一：修改系统日期（不推荐）**
- 修改电脑/手机系统日期到 1月1日
- 添加记录
- 查看是否能正常创建 "1月1日" 的记录

**方法二：导入包含新日期的数据文件**
- 使用下方提供的测试数据文件

---

## 🧪 测试数据文件

### 示例1：包含12月19-25日数据的文件

创建一个名为 `测试数据_12月19-25日.json` 的文件：

```json
{
  "version": "1.0",
  "exportDate": "2025-12-18T12:00:00.000Z",
  "data": [
    {
      "date": "12月19日",
      "weekday": "周四",
      "weight": 67.5,
      "fasting": 92,
      "steps": 6500,
      "meals": [
        {
          "type": "breakfast",
          "time": "08:30",
          "foods": ["玄米饭", "鸡蛋", "西兰花"],
          "glucose": 112
        },
        {
          "type": "lunch",
          "time": "12:30",
          "foods": ["鸡胸肉", "青菜", "杂粮饭"],
          "glucose": 118
        },
        {
          "type": "dinner",
          "time": "18:30",
          "foods": ["鱼", "豆腐", "玄米"],
          "glucose": 108
        }
      ]
    },
    {
      "date": "12月20日",
      "weekday": "周五",
      "weight": 67.3,
      "fasting": 88,
      "steps": 7200,
      "meals": [
        {
          "type": "breakfast",
          "time": "09:00",
          "foods": ["全麦面包", "鸡蛋", "牛奶"],
          "glucose": 125
        },
        {
          "type": "lunch",
          "time": "13:00",
          "foods": ["牛肉", "蔬菜沙拉", "玄米"],
          "glucose": 115
        },
        {
          "type": "dinner",
          "time": "19:00",
          "foods": ["豆腐", "青菜", "纳豆", "玄米"],
          "glucose": 102
        }
      ]
    }
  ]
}
```

**导入测试步骤：**
1. 将上面的 JSON 内容保存为文件
2. 在应用中点击"导入数据"
3. 选择这个文件
4. **预期结果**：日期选择器显示 19日、20日

---

## 🐛 已知问题和注意事项

### 1. 日期格式限制
- 当前只支持"X月X日"格式，不包含年份
- 跨年时可能需要手动清理旧年数据

### 2. 浏览器兼容性
- Safari 浏览器：确保未开启"无痕浏览"模式，否则无法保存数据
- Chrome/Edge：完全支持
- 微信内置浏览器：支持，但可能有缓存问题

### 3. 数据安全
- ⚠️ 数据保存在浏览器 localStorage
- ⚠️ 清除浏览器缓存会丢失数据
- ⚠️ 每周至少导出备份一次

### 4. 性能限制
- localStorage 容量限制约 5-10MB
- 建议保留最近 3 个月的数据
- 更早的数据应导出归档

---

## ✅ 测试通过标准

### 核心功能必须通过：
- ✅ 能成功添加今天的新记录
- ✅ 数据能成功导出为 JSON 文件
- ✅ 导出的数据能成功导入恢复
- ✅ 关闭浏览器后数据不丢失
- ✅ 日期选择器能显示新添加的日期
- ✅ 统计图表能正确更新

### 界面必须正常：
- ✅ 手机端显示正常（响应式）
- ✅ 所有按钮都能点击
- ✅ 表单验证正常工作
- ✅ 提示信息清晰明确

---

## 🔧 遇到问题如何反馈

如果测试发现问题，请提供以下信息：

1. **问题描述**：详细说明发生了什么
2. **复现步骤**：如何重现这个问题
3. **预期结果**：你认为应该怎样
4. **实际结果**：实际发生了什么
5. **浏览器信息**：Chrome/Safari/微信等，版本号
6. **设备信息**：iPhone/Android/电脑等
7. **截图**：如果可能，提供截图

**反馈渠道：**
- GitHub Issues: https://github.com/KKAIlab/tangma-diary/issues

---

**测试时间：2025-12-18**
**版本：v1.0**
